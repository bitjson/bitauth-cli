# Contribution Guide

Thanks for your interest in contributing to BitAuth CLI! We're excited to work with you.

## Getting Started

Here's some information to help you get started.

### Clone, Install, Link

To install your modified version of BitAuth CLI, use [Yarn link](https://yarnpkg.com/lang/en/docs/cli/link/):

```sh
# clone the repo
git clone https://github.com/bitauth/bitauth-cli.git
cd bitauth-cli/

#install dependencies
yarn

# replace your global `bitauth` with this project:
yarn link
```

### Package Scripts

The [package scripts in `package.json`](../package.json) include a lot of useful commands, run them with `yarn`:

```sh
# run the tests:
yarn test
# automatically fix formatting, eslint errors:
yarn fix
# etc.
```

### Use a Development Data Directory

To avoid accidentally modifying an existing `~/.bitauth` data directory during development, consider configuring a custom data directory in your `.bashrc`, `.zshrc`, or other shell configuration file. You may also want to set your `BITAUTH_LOG_LEVEL` to `debug`:

```sh
# Bitauth CLI
export BITAUTH_DATA_DIR='~/.bitauth-dev/primary';
export BITAUTH_LOG_LEVEL='debug';
```

After sourcing the change, verify your new settings by running `bitauth config`.

### Oclif CLI Framework

We use the [Oclif CLI framework](https://oclif.io/docs/introduction), check out their documentation to get up to speed quickly.

## Other Development Tips

### Debugging Oclif Commands

You can debug Oclif commands using the `$DEBUG` environment variable. Set it to the scope you're interested in, or use `*` for full logging.

```sh
# full logging:
env DEBUG=\* bitauth init --help
# filter by `bitauth`:
env DEBUG="bitauth" bitauth init --help
```

### Reviewing Bitauth CLI Logs

Bitauth CLI logs extensively to the `logs--sensitive-do-not-share.ndjson` (newline-delimited JSON) file in the active Bitauth data directory. For an convenient live-view of the logs, try:

```sh
yarn log
```

### Test a Full Build

```sh
yarn pack
```

### Update Readme Reference Section

```sh
yarn readme
```

This also happens automatically during `yarn pack`.

### Update Autocomplete

First, follow the regular instructions from `bitauth autocomplete`. If you make changes to the CLI which must change the autocomplete, simply re-run:

```sh
# regenerate completions
bitauth autocomplete:script
```

You can ignore the output; the completions will be regenerated in-place.

### If Something Isn't Updating

Delete the `oclif.manifest.json`, since it will be used if present. (It was generated by the `prepack` script.)

## Design Guidelines

Assorted notes on design choices in this application.

### Use "Alias" rather than "Identifer"

A "Bitauth ID" or "Bitauth Identifier" is a string beginning with `bitauth:...` which encodes the transaction ID from which a particular identity is traced (it's `authhead`).

To avoid confusion, we avoid using the terms "ID" or "identifier" for any other elements in Bitauth CLI. Rather, we prefer the term "alias" for any non-standardized short identifiers, e.g. "wallet alias", "template alias", "identity alias", "transaction proposal alias", etc. ()
